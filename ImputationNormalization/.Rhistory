p <- ggplot(blimp, aes(x=BLANKS, y=TTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='Nominal P-value')
#change file name
tiff("Imputed_Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blimp, aes(x=BLANKS, y=TTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='Nominal P-value')
#change file name
tiff("Imputed_Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(xdata, aes(X2, log10(value))) +
geom_boxplot() + stat_boxplot(geom = 'errorbar') +
theme_classic()+
theme(axis.text.x = element_text(angle=90, hjust=1))
#change file name
tiff("Imputed_Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blimp, aes(x=BLANKS, y=TTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='Nominal P-value')
#change file name
tiff("Imputed_Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
TMTData.df <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel.csv", header=TRUE,quote='\"', sep=',', comment.char='')
bl <- data.frame(TMTData.df[24:25])
TMTImputed.df  <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel_Imputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
blimp <- data.frame(TMTData.df[24:25])
p <- ggplot(blimp, aes(x=BLANKS, y=TTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='Nominal P-value')
#change file name
tiff("Imputed_Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blimp, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Imputed_Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
scale_y_continuous(name="-log10(Nominal P-value)", limits=c(0,4))+
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
scale_y_discrete(name="-log10(Nominal P-value)", limits=c(0,4))+
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
scale_y_continuous(name="-log10(Nominal P-value)", limits=c(0,4,0.5))+
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(col='red',size = 2.5) +
ylim("0", "0.5", "1", "1.5", "2", "2.5", "3", "3.5", "4")
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
#library(plyr)
library(MSnbase)
library(reshape)
library(lattice)
library(ggplot2)
library(limma)
library(RColorBrewer)
library(ROTS)
library(seqinr)
library(ggrepel)
library(MKmisc) # glog2
library(gplots)
library(devtools)
library(rgl)
library(pca3d)
X11.options(width=5, height=5, xpos=1200, ypos=500)
options(editor="/usr/bin/vim")
options(stringsAsFactors=FALSE)
blankttest.df  <- read.table("Imputed_vs_NotImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(bl, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=Group),size = 2.5) +
theme_classic()
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=Group),size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=BLANKS, y=TTEST)) +
geom_point(aes(colour=Group),size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=Group),size = 2.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=Group),size = 0.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=Group),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
View(blankttest.df)
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=Group),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=BLANKS, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
View(blankttest.df)
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank_Volcano.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed_vs_MCARimputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
blankttest.df  <- read.table("Imputed_vs_NotImputed_vs_MCARimputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank_Volcano.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed_vs_MCARimputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank_Volcano.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed_vs_MCARimputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 6, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed_vs_MCARimputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOGTTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 8, height = 6, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOG10TTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 8, height = 6, units = 'in', res = 600)
plot(p)
dev.off()
blankttest.df  <- read.table("Imputed_vs_NotImputed_vs_MCARimputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOG10TTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
theme_classic()
p <- p + labs(title='P-value vs Missing Channels', x='Number of Blank Channels', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 8, height = 6, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOG10TTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
geom_hline(yintercept=-log(0.05,10)) +
theme_classic()
p <- p + labs(title='Morphine vs Control ', x='log2(FC)', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 8, height = 6, units = 'in', res = 600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOG10TTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
geom_hline(yintercept=-log(0.05,10)) +
theme_classic()
p <- p + labs(title='Morphine vs Control Comparison of Imputed vs Not Imputed vs MCAR Imputed', x='log2(FC)', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 8, height = 6, units = 'in', res = 600)
plot(p)
dev.off()
TMTData.df <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df[16:23])
View(tmt)
#change file name
e <- exprs(tmt)
#change file name
pd <- c('MOR', 'CTL')
p <- plotPCA_sc_v2(tmt, pd, '1', title=paste('', '')) +
theme_classic()
plotPCA_sc_v2 <- function(m, pdat, component, title='') { # select components
## component: either 1 (comp1vscomp2) or 2 (comp2vscomp3)
pca <- prcomp(m, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
spl <- df$Samples
cl <- pdat[match(spl, names(pdat))]
spl <- ifelse(cl==0, input$pcacontrol, input$pcatreatment)
df$Samples <- spl
if (component=='1') {
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
} else if (component=='2') {
p <- ggplot(df, aes(PC2, PC3, colour=Samples)) + geom_point(size=2)
#p <- ggplot(df, aes(PC3, PC4, colour=Samples)) + geom_point(size=2)
}
p <- p + theme(legend.position='right', legend.title=element_blank())
p <- p + labs(title=title)
return(p)
}
#change file name
pd <- c('MOR', 'CTL')
p <- plotPCA_sc_v2(tmt, pd, '1', title=paste('', '')) +
theme_classic()
tiff(paste("/Users/ald533/Desktop/ProductionAndInformatics/FASInformatics/Figures/", input$outputfile, "_PCA.tiff"), width = 4, height = 4, units = 'in', res = 600)
tiff(paste("NotImputed_PCA.tiff"), width = 4, height = 4, units = 'in', res = 600)
plot(p)
dev.off()
#change file name
pd <- c('MOR', 'CTL')
x <- plotPCA_sc_v2(tmt, pd, '1', title=paste('', '')) +
theme_classic()
tiff(paste("NotImputed_PCA.tiff"), width = 4, height = 4, units = 'in', res = 600)
plot(x)
dev.off()
View(tmt)
TMTData.df <- read.table("PCA_Rmatrix_notImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
x <- plotPCA_sc_v2(tmt, pd, '1', title=paste('', '')) +
theme_classic()
TMTData.df <- read.table("PCA_Rmatrix_notImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
x <- plotPCA_sc_v2(tmt, pd, '1', title=paste('', '')) +
theme_classic()
tiff(paste("NotImputed_PCA.tiff"), width = 4, height = 4, units = 'in', res = 600)
plot(x)
dev.off()
View(x)
View(p)
TMTData.df <- read.table("PCA_Rmatrix_notImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
View(df)
View(pca)
View(df)
df <- as.data.frame(pca$rotation[, 1:8])
View(df)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
View(df)
View(tmt)
TMTData.df <- read.table("PCA_Rmatrix_notImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
View(df)
spl <- df$Samples
cl <- pdat[match(spl, names(pdat))]
spl <- ifelse(cl==0, input$pcacontrol, input$pcatreatment)
df$Samples <- spl
pdat=c('MOR','CTL')
spl <- df$Samples
cl <- pdat[match(spl, names(pdat))]
spl <- ifelse(cl==0, input$pcacontrol, input$pcatreatment)
df$Samples <- spl
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
View(df)
pdat=c('1', '1', '1', '1', '0', '0', '0', '0')
spl <- df$Samples
cl <- pdat[match(spl, names(pdat))]
spl <- ifelse(cl==0, input$pcacontrol, input$pcatreatment)
df$Samples <- spl
View(df)
#change file name
pd <- c('MOR', 'CTL')
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
pdat=c('1', '1', '1', '1', '0', '0', '0', '0')
spl <- df$Samples
cl <- pdat[match(spl, names(pdat))]
spl <- ifelse(cl==0, input$pcacontrol, input$pcatreatment)
df$Samples <- spl
View(df)
pdat=
df$Samples <- c('1', '1', '1', '1', '0', '0', '0', '0')
View(df)
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
p <- p + theme(legend.position='right', legend.title=element_blank())
p <- p + labs(title=title)
tiff(paste("NotImputed_PCA.tiff"), width = 4, height = 4, units = 'in', res = 600)
plot(x)
dev.off()
View(df)
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
tiff("PCA_nofileSep.tiff", width = 6, height = 4, units = 'in', res=600)
plot(p)
dev.off()
df$Samples <- c('MOR', 'MOR', 'MOR', 'MOR', 'CTL', 'CTL', 'CTL', 'CTL')
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
tiff("PCA_nofileSep.tiff", width = 6, height = 4, units = 'in', res=600)
plot(p)
dev.off()
View(df)
TMTData.df <- read.table("HalfImputed_PCA.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
TMTData.df <- read.table("HalfImputed_PCA.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
df$Samples <- c('MOR', 'MOR', 'MOR', 'MOR', 'CTL', 'CTL', 'CTL', 'CTL')
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
tiff("PCA_MCARImputed.tiff", width = 6, height = 4, units = 'in', res=600)
plot(p)
dev.off()
TMTData.df <- read.table("HalfImputed_PCA.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
df$Samples <- c('MOR', 'MOR', 'MOR', 'MOR', 'CTL', 'CTL', 'CTL', 'CTL')
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
tiff("PCA_MCARImputed.tiff", width = 6, height = 4, units = 'in', res=600)
plot(p)
dev.off()
TMTData.df <- read.table("HalfImputed_PCA.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
TMTData.df <- read.table("PCA_Rmatrix_notImputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
TMTData.df <- read.table("PCA_Imputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df)
#change file name
pd <- c('MOR', 'CTL')
pca <- prcomp(tmt, scale=FALSE)
df <- as.data.frame(pca$rotation[, 1:4])
df <- namerows(df, col.name='Samples')
df$Samples <- c('MOR', 'MOR', 'MOR', 'MOR', 'CTL', 'CTL', 'CTL', 'CTL')
p <- ggplot(df, aes(PC1, PC2, colour=Samples)) + geom_point(size=2)
tiff("PCA_MCARImputed.tiff", width = 6, height = 4, units = 'in', res=600)
plot(p)
dev.off()
tiff("PCA_Imputed.tiff", width = 6, height = 4, units = 'in', res=600)
plot(p)
dev.off()
TMTData.df <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df[16:23])
View(tmt)
TMTImputed.df  <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel_Imputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmtimp <- as.matrix(TMTImputed.df[16:23])
y <- normalizeVSN(tmt)
ydata <- melt(tmt)
x <- normalizeVSN(tmtimp)
xdata <- melt(tmtimp)
p <- ggplot(xdata, aes(X2, log10(value))) +
geom_boxplot() + stat_boxplot(geom = 'errorbar') +
theme_classic()+
theme(axis.text.x = element_text(angle=90, hjust=1))
tiff("vsnNormalizationBox_Imputed.tiff", width = 4, height = 4, units = 'in', res=600)
plot(p)
dev.off()
p <- ggplot(ydata, aes(X2, log10(value))) +
geom_boxplot() + stat_boxplot(geom = 'errorbar') +
theme_classic()+
theme(axis.text.x = element_text(angle=90, hjust=1))
tiff("vsnNormalizationBox_notImputed.tiff", width = 4, height = 4, units = 'in', res=600)
plot(p)
dev.off()
p <- ggplot(blankttest.df, aes(x=LOG2FC, y=LOG10TTEST)) +
geom_point(aes(colour=GROUP),size = 1.5) +
geom_hline(yintercept=-log(0.05,10)) +
theme_classic()
p <- p + labs(title='Morphine vs Control Comparison of Imputed vs Not Imputed vs MCAR Imputed', x='log2(FC)', y='-log10(Nominal P-value)')
#change file name
tiff("Missing vs Blank vs Half_Volcano.tiff", width = 8, height = 6, units = 'in', res = 200)
plot(p)
dev.off()
TMTData.df <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmt <- as.matrix(TMTData.df[16:23])
TMTImputed.df  <- read.table("200113L_SAM6526_BY53_CC_PO4_pH_All_KB_Percolator_sitelevel_Imputed.csv", header=TRUE,quote='\"', sep=',', comment.char='')
tmtimp <- as.matrix(TMTImputed.df[16:23])
y <- normalizeVSN(tmt)
ydata <- melt(tmt)
x <- normalizeVSN(tmtimp)
xdata <- melt(tmtimp)
p <- ggplot(ydata, aes(X2, log10(value))) +
geom_boxplot() + stat_boxplot(geom = 'errorbar') +
theme_classic()+
theme(axis.text.x = element_text(angle=90, hjust=1))
tiff("vsnNormalizationBox_notImputed.tiff", width = 4, height = 4, units = 'in', res=600)
tiff("vsnNormalizationBox_notImputed.tiff", width = 4, height = 4, units = 'in', res=200)
plot(p)
dev.off()
p <- ggplot(xdata, aes(X2, log10(value))) +
geom_boxplot() + stat_boxplot(geom = 'errorbar') +
theme_classic()+
theme(axis.text.x = element_text(angle=90, hjust=1))
tiff("vsnNormalizationBox_Imputed.tiff", width = 4, height = 4, units = 'in', res=200)
plot(p)
dev.off()
